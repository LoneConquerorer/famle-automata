(this["webpackJsonpm-auto"]=this["webpackJsonpm-auto"]||[]).push([[0],{112:function(e,t){},115:function(e,t,n){},116:function(e,t,n){},117:function(e,t,n){},162:function(e,t,n){},163:function(e,t,n){},164:function(e,t,n){},165:function(e,t,n){},168:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),o=n(65),r=n.n(o),c=(n(76),n(77),n(25)),l=n(1),i=n(21),u=n(10),m=n(66),p=n.n(m),h=n(67),f=n.n(h),v=n(3),d=n.n(v),b=n(68),E=n.n(b),k=(n(115),n(14)),g=n(15),y=n(17),w=n(16),N=(n(116),function(e){Object(y.a)(n,e);var t=Object(w.a)(n);function n(e){var a;return Object(k.a)(this,n),(a=t.call(this,e)).state={instruments:["","synth ","amsynth ","fmsynth ","mono ","duo ","kick "]},a}return Object(g.a)(n,[{key:"renderColor",value:function(){var e="square ";return this.props.preview&&(e+="preview "),this.props.cell&&(e+="cell "),this.props.note&&(e+=this.state.instruments[this.props.note]),s.a.createElement("button",{className:e,onClick:this.props.onClick,onMouseDown:this.props.mouseDown,onMouseEnter:this.props.mouseEnter,onMouseUp:this.props.mouseUpContext,onContextMenu:this.props.mouseUpContext})}},{key:"shouldComponentUpdate",value:function(e,t){return e.preview!==this.props.preview||(e.cell!==this.props.cell||e.note!==this.props.note)}},{key:"render",value:function(){return this.props.note&&this.props.cell&&!this.props.preview&&this.props.playNote(this.props.note),s.a.createElement("div",{className:"squareContainer"},this.renderColor())}}]),n}(s.a.Component)),C=function(e){Object(y.a)(n,e);var t=Object(w.a)(n);function n(){return Object(k.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"renderSquare",value:function(e){var t=this;return s.a.createElement(N,{key:e,cell:this.props.cells[e],preview:this.props.preview[e],note:this.props.notes[e],mouseDown:function(){return t.props.mouseDown(e)},mouseEnter:function(){return t.props.mouseEnter(e)},mouseUpContext:function(){return t.props.mouseUpContext()},playNote:function(n){return t.props.playNote(e,n)}})}},{key:"render",value:function(){var e=this,t=this.props.rows,n=this.props.cols;return s.a.createElement("div",{className:"game-board"},Object(i.a)(new Array(t)).map((function(t,a){return s.a.createElement("div",{className:"board-row",key:a},Object(i.a)(new Array(n)).map((function(t,s){return e.renderSquare(a*n+s)})))})))}}]),n}(s.a.Component);var S=function(e){Object(y.a)(n,e);var t=Object(w.a)(n);function n(e){var a;return Object(k.a)(this,n),a=t.call(this,e),d.a.Transport.start(),d.a.Master.volume.value=-30,function(e,t){e.emit("boardInit",t)}(a.props.socket,(function(e){var t=e.preview,n=e.cells,s=e.notes;return a.setState({preview:t,cells:n,notes:s})})),function(e,t){e.on("tempo",(function(e){return t(e)}))}(a.props.socket,(function(e){d.a.Transport.bpm.value=e})),function(e,t){e.on("previewUpdate",(function(e){var n=e.loc,a=e.value;return t(n,a)}))}(a.props.socket,(function(e,t){var n=a.state.preview.slice();n[e]=t,a.setState({preview:n})})),function(e,t){e.on("notesUpdate",(function(e){var n=e.loc,a=e.type,s=e.value;return t(n,a,s)}))}(a.props.socket,(function(e,t,n){var s=a.state.notes.slice();s[e]===t?s[e]=n:s[e]=n||s[e],a.setState({notes:s})})),function(e,t){e.on("cellsUpdate",(function(e){var n=e.remove,a=e.cells;return t(n,a)}))}(a.props.socket,(function(e,t){for(var n=a.state.preview.slice(),s=0;s<e.length;s++)n[e[s]]=0;a.setState({cells:t,preview:n})})),function(e,t){e.on("previewClose",(function(e){var n=e.arr;return t(n)}))}(a.props.socket,(function(e){if(e){for(var t=a.state.preview.slice(),n=0;n<e.length;n++)t[e[n]]=0;a.setState({preview:t})}})),function(e,t){e.on("notesCleared",(function(){return t()}))}(a.props.socket,(function(){a.setState({notes:Array(a.props.rows*a.props.cols).fill(0)})})),function(e,t){e.on("cellsCleared",(function(){return t()}))}(a.props.socket,(function(){a.setState({cells:Array(a.props.rows*a.props.cols).fill(0)})})),a.state={xIsNext:!0,stepNumber:0,rows:a.props.rows,cols:a.props.cols,socket:a.props.socket,preview:Array(a.props.rows*a.props.cols).fill(0),cells:Array(a.props.rows*a.props.cols).fill(0),notes:Array(a.props.rows*a.props.cols).fill(0),sounds:new Map,octaves:Math.ceil(a.props.rows/7),pitches:["C","D","E","F","G","A","B"],mouseClicked:!1,mouseValue:null,timestamp:0},a}return Object(g.a)(n,[{key:"handleToggle",value:function(e,t,n){var a=this.props.clickType;if(0===a){var s=this.state.preview;n?(s[e]=s[e]?0:1,this.setState({preview:s,mouseClicked:t,mouseValue:s[e]})):(s[e]=this.state.mouseValue,this.setState({preview:s,mouseClicked:t})),function(e,t){var n=t.loc,a=t.value;e.emit("previewClick",{loc:n,value:a})}(this.props.socket,{loc:e,value:s[e]})}else{var o=this.state.notes.slice();n?(o[e]=o[e]===a?0:a,this.setState({notes:o,mouseClicked:t,mouseValue:o[e]})):(o[e]===a?o[e]=this.state.mouseValue:o[e]=this.state.mouseValue?this.state.mouseValue:o[e],this.setState({notes:o,mouseClicked:t})),function(e,t){var n=t.loc,a=t.type,s=t.value;e.emit("updateNotes",{loc:n,type:a,value:s})}(this.props.socket,{loc:e,type:a,value:o[e]})}}},{key:"handleClick",value:function(e){this.handleToggle(e,!1,!1)}},{key:"handleMouseDown",value:function(e){this.handleToggle(e,!0,!0)}},{key:"handleMouseEnter",value:function(e){this.state.mouseClicked&&this.handleToggle(e,!0,!1)}},{key:"handleMouseUpContext",value:function(){this.setState({mouseClicked:!1,mouseValue:null})}},{key:"playNote",value:function(e,t){if("started"===d.a.Transport.state){if("running"!==d.a.context.state&&d.a.context.resume(),!(d.a.Transport.seconds<2)){var n=Math.floor(e/this.state.cols),a=e%this.state.cols,s=this.state.rows-n-1,o=Math.floor(s/this.state.pitches.length),r=s%this.state.pitches.length,c="",l="4n",i="",u=new d.a.PanVol;switch(u.pan.value=a*(2/(this.state.cols-1))-1,t){case 1:i=new d.a.Synth,c=this.state.pitches[r]+(o+2).toString(),l="4n";break;case 2:i=new d.a.AMSynth,c=this.state.pitches[r]+(o+2).toString(),l="4n";break;case 3:i=new d.a.FMSynth,c=this.state.pitches[r]+(o+2).toString(),l="4n";break;case 5:i=new d.a.DuoSynth,c=this.state.pitches[r]+(o+2).toString(),l="4n";break;case 6:i=new d.a.MembraneSynth,c=this.state.pitches[r]+o.toString(),l="1n"}""!==c&&""!==l&&""!==i&&(i.chain(u,d.a.Master),i.triggerAttackRelease(c,l))}}else d.a.Transport.start()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"game"},s.a.createElement("div",{className:"game-board-container"},s.a.createElement(C,{preview:this.state.preview,cells:this.state.cells,notes:this.state.notes,onClick:function(t){return e.handleClick(t)},mouseDown:function(t){return e.handleMouseDown(t)},mouseEnter:function(t){return e.handleMouseEnter(t)},mouseUpContext:function(){return e.handleMouseUpContext()},playNote:function(t,n){return e.playNote(t,n)},rows:this.state.rows,cols:this.state.cols})))}}]),n}(s.a.Component),j=(n(117),function(e){var t=e.message,n=e.setMessage,a=e.sendMessage;return s.a.createElement("form",{className:"form"},s.a.createElement("input",{className:"input",type:"text",value:t,onChange:function(e){return n(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?a(e):null}}),s.a.createElement("button",{className:"sendButton",onClick:function(e){return a(e)}},"Send"))}),O=n(69),M=n.n(O),x=(n(162),function(e){var t=e.message,n=t.user,a=t.text,o=!1,r=e.name.trim().toLowerCase();return n===r&&(o=!0),o?s.a.createElement("div",{className:"messageContainer justifyStart"},s.a.createElement("div",{className:"nameBox"},s.a.createElement("p",{className:"colorWhite"},r,":")),s.a.createElement("div",{className:"messageBox backgroundPurple"},s.a.createElement("p",{className:"messageText colorWhite"},a))):s.a.createElement("div",{className:"messageContainer justifyStart"},s.a.createElement("div",{className:"nameBox"},s.a.createElement("p",{className:"colorWhite"},n,":")),s.a.createElement("div",{className:"messageBox backgroundLight"},s.a.createElement("p",{className:"messageText colorDark"},a)))}),T=(n(163),function(e){var t=e.messages,n=e.name;return s.a.createElement(M.a,{className:"messages"},t.map((function(e,t){return s.a.createElement("div",{key:t},s.a.createElement(x,{message:e,name:n}))})))}),D=(n(164),function(e){var t=e.tempo,n=e.setTempo,a=e.sendTempo;return s.a.createElement("form",{className:"tempo-form"},s.a.createElement("input",{className:"tempo",type:"number",value:t,onChange:function(e){return n(e.target.value)},onKeyPress:function(e){return"Enter"===e.key?a(e):null}}),s.a.createElement("button",{className:"tempoButton",onClick:function(e){return a(e)}},"Set Tempo"))}),U=E()("https://famle-automata.herokuapp.com/"),A=function(e){var t=e.location,n=Object(a.useState)(""),o=Object(u.a)(n,2),r=o[0],c=o[1],l=Object(a.useState)(""),m=Object(u.a)(l,2),h=m[0],v=m[1],b=Object(a.useState)("0"),E=Object(u.a)(b,2),k=E[0],g=E[1],y=Object(a.useState)(0),w=Object(u.a)(y,2),N=w[0],C=w[1],O=Object(a.useState)([]),M=Object(u.a)(O,2),x=M[0],A=M[1];Object(a.useEffect)((function(){var e=p.a.parse(t.search);return c(e.name),U.emit("join",e,(function(e){console.log(e)})),U.emit("subscribeToTimer",(function(e){return g(e)})),function(){U.emit("disconnect"),U.off()}}),[t.search]),Object(a.useEffect)((function(){U.on("message",(function(e){A((function(t){return[].concat(Object(i.a)(t),[e])}))})),U.on("tempo",(function(e){g(e)}))}),[]);return s.a.createElement("div",{className:"outerContainer"},s.a.createElement("div",{className:"left-container"},s.a.createElement(S,{rows:28,cols:50,socket:U,clickType:N})),s.a.createElement("div",{className:"right-container"},s.a.createElement("div",{className:"right-top-container"},s.a.createElement(T,{messages:x,name:r}),s.a.createElement(j,{message:h,setMessage:v,sendMessage:function(e){e.preventDefault(),h&&U.emit("sendMessage",h,(function(){return v("")}))}})),s.a.createElement("div",{className:"right-bottom-container"},s.a.createElement("div",{className:"tempo-text"},"Tempo"),s.a.createElement("div",{className:"tempo-align"},s.a.createElement(D,{tempo:k,setTempo:g,sendTempo:function(e){e.preventDefault(),k&&U.emit("tempoChange",k)}})),s.a.createElement("div",null,s.a.createElement("button",{className:"preview cell-button",onClick:function(e){return C(0)}},"cells"),s.a.createElement("button",{className:"cell push-button",onClick:function(e){U.emit("previewPush")}},"push changes")),s.a.createElement("div",{className:"button-layers"},s.a.createElement("div",null,s.a.createElement("button",{className:"synth-button note-button",onClick:function(e){return C(1)}},"Synth")),s.a.createElement("div",null,s.a.createElement("button",{className:"amsynth-button note-button",onClick:function(e){return C(2)}},"AMSynth")),s.a.createElement("div",null,s.a.createElement("button",{className:"fmsynth-button note-button",onClick:function(e){return C(3)}},"FMSynth")),s.a.createElement("div",null),s.a.createElement("div",null,s.a.createElement("button",{className:"duo-button note-button",onClick:function(e){return C(5)}},"DuoSynth")),s.a.createElement("div",null,s.a.createElement("button",{className:"kick-button note-button",onClick:function(e){return C(6)}},"Bass/Kick"))),s.a.createElement("div",{className:"settings-layer"},s.a.createElement("div",{className:"bottom-div-half"}),s.a.createElement("div",{className:"bottom-div-half"},s.a.createElement("button",{className:"preview cell-button",onClick:function(e){return f()(d.a.context)}},"Start Sound"),s.a.createElement("button",{className:"clear-button  center-button",onClick:function(e){U.emit("clearCells")}},"Clear Cells"),s.a.createElement("button",{className:"clear-button  push-button",onClick:function(e){U.emit("clearNotes")}},"Clear Notes"))))))},B=(n(165),function(){var e=Object(a.useState)(""),t=Object(u.a)(e,2),n=t[0],o=t[1];return s.a.createElement("div",{className:"joinOuterContainer"},s.a.createElement("div",{className:"joinInnerContainer"},s.a.createElement("h1",{className:"heading"},"FaMLE;Automata"),s.a.createElement("div",null,s.a.createElement("input",{placeholder:"Username",className:"joinInput",type:"text",onChange:function(e){return o(e.target.value)}})),s.a.createElement(c.b,{onClick:function(e){return n?null:e.preventDefault()},to:"/game?name=".concat(n)},s.a.createElement("button",{className:"button mt-20",type:"submit"},"Join"))))}),V=function(){return s.a.createElement(c.a,null,s.a.createElement(l.a,{path:"/",exact:!0,component:B}),s.a.createElement(l.a,{path:"/game",component:A}))};r.a.render(s.a.createElement(V,null),document.getElementById("root"))},71:function(e,t,n){e.exports=n(168)},76:function(e,t,n){},77:function(e,t,n){}},[[71,1,2]]]);
//# sourceMappingURL=main.71c582d3.chunk.js.map